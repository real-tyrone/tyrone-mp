on_country_released_as_independent = {
    on_actions = {
		liberate_country_as_subject_stuff
	}
}

liberate_country_as_subject_stuff = {
	effect = {
		if = {
			limit = {
				has_variable = waddle_female
			}
			remove_variable = waddle_female

			random_country = {
				limit = {
					has_variable = waddle_male
				}
				remove_variable = waddle_male
				create_diplomatic_pact = {
					country = scope:target
					type = protectorate
				}
				change_infamy = {
					value = {
						add = 2
						scope:target = {
							multiply = {
								add = {
									every_scope_state = {
										add = {
											value = state_population
											divide = define:NDiplomacy|WAR_GOAL_INFAMY_POPULATION_SCALING_FACTOR
											multiply = define:NDiplomacy|WAR_GOAL_INFAMY_POPULATION_SCALING_MULTIPLIER
											multiply = {
												value = 1.25
											}
											if = {
												limit = {
													is_homeland_of_country_cultures = root
												}
												multiply = {
													value = 1
													add = define:NDiplomacy|WAR_GOAL_INFAMY_HOMELAND_FACTOR
												}
											}
											if = {
												limit = {
													is_incorporated = no
												}
												multiply = {
													value = 1
													add = define:NDiplomacy|WAR_GOAL_INFAMY_UNINCORPORATED_FACTOR
												}
											}
											max = define:NDiplomacy|WAR_GOAL_INFAMY_POPULATION_SCALING_MULTIPLIER_MAX_PER_STATE
										}
									}
								}
								max = define:NDiplomacy|WAR_GOAL_INFAMY_POPULATION_SCALING_MULTIPLIER_MAX_TOTAL
							}
						}
					}
				}
			}
		}
	}
}